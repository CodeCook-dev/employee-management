<div class="date-picker-container">
  <!-- Trigger Button -->
  <div
    class="date-trigger"
    [class.disabled]="disabled"
    [class.placeholder]="!selectedDate"
    (click)="openModal()"
  >
    <div class="date-content">
      <app-calendar-icon />
      <span class="date-value">
        {{ selectedDate ? formatDate(selectedDate) : placeholder }}
      </span>
    </div>
  </div>

  <!-- Date Picker Modal -->
  <div
    class="modal-overlay"
    [class.open]="isModalOpen"
    (click)="closeModal()"
  ></div>

  <div class="modal-content" [class.open]="isModalOpen">
    <div class="calendar-container">
      <!-- Quick Selection Buttons -->
      <div class="quick-selection" *ngIf="variant === 'start'">
        <button class="quick-btn" (click)="selectToday()">Today</button>
        <button class="quick-btn" (click)="selectNextMonday()">
          Next Monday
        </button>
        <button class="quick-btn" (click)="selectNextTuesday()">
          Next Tuesday
        </button>
        <button class="quick-btn" (click)="selectAfterOneWeek()">
          After 1 week
        </button>
      </div>

      <div class="quick-selection" *ngIf="variant === 'end'">
        <button class="quick-btn" (click)="selectNoDate()">No date</button>
        <button
          class="quick-btn"
          [class.disabled]="isTodayDisabled()"
          (click)="selectToday()"
        >
          Today
        </button>
      </div>

      <!-- Month Navigation -->
      <div class="month-navigation">
        <button
          class="nav-btn"
          [class.disabled]="isPreviousMonthDisabled()"
          (click)="previousMonth()"
          [disabled]="isPreviousMonthDisabled()"
        >
          <svg width="9" height="14" viewBox="0 0 9 14" fill="none">
            <path
              d="M0.873302 8.35895L5.39504 13.4065C5.94577 14.0212 6.57591 14.1584 7.28548 13.818C7.9962 13.479 8.35156 12.8726 8.35156 11.999L8.35156 2.00101C8.35156 1.1274 7.9962 0.521045 7.28548 0.181954C6.57591 -0.158431 5.94577 -0.0212413 5.39504 0.593521L0.873302 5.64105C0.699389 5.83519 0.568956 6.0455 0.481999 6.27199C0.395043 6.49848 0.351563 6.74115 0.351563 7C0.351563 7.25885 0.395043 7.50152 0.481999 7.72801C0.568956 7.9545 0.699389 8.16481 0.873302 8.35895Z"
              fill="#949C9E"
            />
          </svg>
        </button>
        <h4 class="month-year">{{ getMonthYearString() }}</h4>
        <button class="nav-btn" (click)="nextMonth()">
          <svg
            width="9"
            height="14"
            viewBox="0 0 9 14"
            fill="none"
            style="transform: rotate(180deg)"
          >
            <path
              d="M0.873302 8.35895L5.39504 13.4065C5.94577 14.0212 6.57591 14.1584 7.28548 13.818C7.9962 13.479 8.35156 12.8726 8.35156 11.999L8.35156 2.00101C8.35156 1.1274 7.9962 0.521045 7.28548 0.181954C6.57591 -0.158431 5.94577 -0.0212413 5.39504 0.593521L0.873302 5.64105C0.699389 5.83519 0.568956 6.0455 0.481999 6.27199C0.395043 6.49848 0.351563 6.74115 0.351563 7C0.351563 7.25885 0.395043 7.50152 0.481999 7.72801C0.568956 7.9545 0.699389 8.16481 0.873302 8.35895Z"
              fill="#949C9E"
            />
          </svg>
        </button>
      </div>

      <!-- Day Headers -->
      <div class="day-headers">
        <div class="day-header" *ngFor="let day of dayHeaders">
          {{ day }}
        </div>
      </div>

      <!-- Calendar Grid -->
      <div class="calendar-grid">
        <div
          *ngFor="let date of calendarDates"
          class="calendar-day"
          [class.other-month]="!date.isCurrentMonth"
          [class.selected]="isTempSelectedDate(date.date)"
          [class.today]="isToday(date.date)"
          [class.disabled]="isDateDisabled(date.date)"
          (click)="selectDate(date.date)"
        >
          {{ date.date.getDate() }}
        </div>
      </div>
    </div>

    <!-- Action Buttons and Preview -->
    <div class="action-section">
      <div class="date-preview">
        <app-calendar-icon />
        <span class="preview-date">{{ getTempPreviewDate() }}</span>
      </div>
      <div class="action-buttons">
        <button
          type="button"
          class="btn btn-secondary"
          (click)="cancelSelection()"
        >
          Cancel
        </button>
        <button
          type="button"
          class="btn btn-primary"
          (click)="confirmSelection()"
        >
          Save
        </button>
      </div>
    </div>
  </div>
</div>
